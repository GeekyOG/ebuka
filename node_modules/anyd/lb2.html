<!DOCTYPE html>
	<html>
		<head>
				<title>17.8.20</title>
<style>
html,body { height: 100% }
.viewport {width: 900px;height: 300px;position: relative;overflow: hidden;}
.father {width: 3000%;height: inherit;transform: translate3d(0, 0, 0);}
.father > div {width: 900px;height: inherit;background: #aaa;float: left;}
.mother {width: 30px;height: inherit;line-height: 300px;text-align: center;
	cursor: pointer;user-select:none;background: rgba(0,0,0,0.15);position: absolute;top: 0;
}
.mother.left { left: 0 }
.mother.right { right: 0 }

</style>
		</head>
		<body>
				<div class = "viewport" id = "example">
						<div class = "father">
							<div>1</div>
							<div>2</div>
							<div>3</div>
							<div>4</div>
							<div>5</div>
						</div>
						<div class = "mother left">左</div>
						<div class = "mother right">右</div>
				</div>
<script>
class Lunbo {
	constructor( e ) {
		this.f = true;
		this.fp = e.fp;
		this.sp = e.sp;
		this.id = e.id;
		this.c = e.v.children[ 0 ];
		this.l = this.c.children.length;
		this.w = this.c.children[ 0 ].offsetWidth;
		this.c.insertBefore( this.c.children[ 0 ].cloneNode( true ) , this.c.lastChild );
		this.c.insertBefore( this.c.children[ this.l - 1 ].cloneNode( true ) , this.c.firstChild );
		e.v.children[ 1 ].addEventListener( 'click' , () => { this.load( --this.id ); } );
		e.v.children[ 2 ].addEventListener( 'click' , () => { this.load( ++this.id ); } );
		this.load( e.id );
	}
	load( id = this.id ) {
		if( !this.f ) return;
		this.f = false;
		this.c.style.cssText = `transition: transform ${ this.sp } ease-in-out;transform: translate3d( ${ -id * this.w }px, 0, 0);`;
		this.fp && Array.from( this.c.children ).forEach( ( c , i , a ) => {
				c.style.cssText = `transition: opacity ${ this.sp } ease-in-out;opacity: 0.5`;
				a[ id ].style.opacity = 1;;
		} );
		this.c.addEventListener( 'transitionend' , () => {
			this.f = true;
			switch( id ) {
				case this.l + 1 : case 0 :
					this.id = id = Math.abs( this.l - id );
					this.c.style.cssText = `transition: none;transform: translate3d( ${ -id * this.w }px, 0, 0);`;
					this.fp && Array.from( this.c.children ).forEach( ( c , i , a ) => {
						c.style.transition = 'none';
						a[ id ].style.opacity = 1;
					} );
					break;
				default :
					this.id = id;
					break;
			};
		} , { once: true } );
	}
};
new Lunbo( {
	v : document.getElementsByClassName( "viewport" )[ 0 ],
	b : false,// 未实现
	id : 1,// 初始化显示
	sp : "1s",// 速度
	fp : true,// 焦点
	auto : true,// 未实现
} );
</script></body></html>
